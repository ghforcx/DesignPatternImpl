# 责任链模式

责任链模式是一种行为设计模式，允许将请求沿着处理者组成的链（责任链）进行发送。链上的悲歌处理者在收到请求后，均可对请求进行处理， 或将其传递给链上的下个处理者。

### 优缺点

优点：

1. 将请求与处理进行解耦；
2. 链路中的节点只需要处理自己关心的请求，对于自己不关心的请求放给下一个节点进行处理；
3. 请求不需要知道链路结构，只需要等待链路处理的结果就行了；
4. 链路的结构比较多灵活，可以更改链路的结构，动态的新增删除责任节点，符合开闭原则；

缺点：

1. 责任链太长，或者请求处理的时间太长，会影响整个链路的性能；
2. 如果节点间存在循环引用，会出现死循环，会导致整个系统崩溃。这个缺点可以通过注册表而非直接引用的方式解决。

### 实现方式

实现方式无非两种，注册表迭代或者直接引用递归。注册表迭代即将所有的处理者注册在注册表中，然后通过迭代的方式逐个访问。直接引用递归即每个处理者都引用下一个（以及上一个）处理者，通过递归的方式访问。相比递归造成的栈空间占用，显然迭代更好。而且通过对注册表的迭代，也可以避免直接引用方法可能导致的死循环的问题。

实现迭代的方法的步骤为：

1. 声明一批处理者 `Processor`;
2. 将所有的处理者 `Processor` 注册到 `Register` 的注册表中（注册表既可以通过 `ArrayList` 实现，也可以通过 `LinkedList` 实现）;
3. 由于 `ArrayList` 和 `LinkedList` 都可以获取双向迭代器 `ListIterator`, 那么通过双向迭代器进行处理即可。

类 `ChainTest` 演示了使用结果和方法

### 应用场景

首先就是当前包中所演示的实现的来源：SpringMVC 拦截器的注册与调用机制。以及类似的 Servlet 框架中的 Filter。进一步地扩展，任何通过代理实现的AOP，都可以把每个切面当做责任链中的处理者，通过责任链模式调用。

# 参考资料

- https://mp.weixin.qq.com/s/ueIrPMalK81sF3sL3WTWTQ
- https://www.liaoxuefeng.com/wiki/1252599548343744/1281319474561057
